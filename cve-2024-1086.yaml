---

- name: check kernel against CVE-2024-1086
  block:
    - ansible.builtin.shell:
        command: |
           version = $(uname -r)
          if [[ ${version} == *"-"* ]]; then
              version=$(echo ${version} | cut -d '-' -f1)
          fi
          echo ${version}
      register: kernel-version

    - ansible.builtin.add_host:
        name: '{{ inventory_hostname }}'
        groups:
          - vuln
          - cve-2024-1086
        when: ( kernel-version.stdout is version('3.15.1', '>=') ) and
              ( kernel-version.stdout is version('6.7.2', '<=') )
